{"expireTime":9007200851888174000,"key":"transformer-remark-markdown-html-ast-80e2089f15940bd9bd839aefc5d86c30-gatsby-remark-responsive-iframegatsby-remark-imagesgatsby-remark-external-linksgatsby-remark-header-custom-idsgatsby-remark-code-replsgatsby-remark-embed-snippetgatsby-remark-use-jsxgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"React v0.13 is right around the corner and so we wanted to discuss some upcoming changes to ReactElement. In particular, we added several warnings to some esoteric use cases of ReactElement. There are no runtime behavior changes for ReactElement - we’re adding these warnings in the hope that we can change some behavior in v0.14 if the changes are valuable to the community.","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":376,"offset":376}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":376,"offset":376}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you use React in an idiomatic way, chances are, you’ll never see any of these warnings. In that case, you can skip this blog post. You can just enjoy the benefits! These changes will unlock simplified semantics, better error messages, stack traces and compiler optimizations!","position":{"start":{"line":4,"column":1,"offset":378},"end":{"line":4,"column":279,"offset":656}}}],"position":{"start":{"line":4,"column":1,"offset":378},"end":{"line":4,"column":279,"offset":656}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"immutable-props"},"children":[{"type":"element","tagName":"a","properties":{"href":"#immutable-props","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Immutable Props ","position":{"start":{"line":6,"column":4,"offset":661},"end":{"line":6,"column":38,"offset":695}}}],"position":{"start":{"line":6,"column":1,"offset":658},"end":{"line":6,"column":38,"offset":695}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In React 0.12, the props object was mutable. It allows you to do patterns like this:","position":{"start":{"line":8,"column":1,"offset":697},"end":{"line":8,"column":85,"offset":781}}}],"position":{"start":{"line":8,"column":1,"offset":697},"end":{"line":8,"column":85,"offset":781}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">var</span> element <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Foo</span></span> <span class=\"token attr-name\">bar</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shouldUseFoo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>foo <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n  element<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>bar <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":10,"column":1,"offset":783},"end":{"line":16,"column":4,"offset":903}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The problem is that we don’t have a convenient way to tell when you’re done mutating.","position":{"start":{"line":18,"column":1,"offset":905},"end":{"line":18,"column":86,"offset":990}}}],"position":{"start":{"line":18,"column":1,"offset":905},"end":{"line":18,"column":86,"offset":990}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-mutating-props-you-dont-own"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-mutating-props-you-dont-own","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: Mutating Props You Don’t Own ","position":{"start":{"line":20,"column":5,"offset":996},"end":{"line":20,"column":81,"offset":1072}}}],"position":{"start":{"line":20,"column":1,"offset":992},"end":{"line":20,"column":81,"offset":1072}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you mutate something, you destroy the original value. Therefore, there is nothing to diff against. Imagine something like this:","position":{"start":{"line":22,"column":1,"offset":1074},"end":{"line":22,"column":131,"offset":1204}}}],"position":{"start":{"line":22,"column":1,"offset":1074},"end":{"line":22,"column":131,"offset":1204}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">var</span> element <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">;</span>\nelement<span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>count <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">return</span> element<span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":24,"column":1,"offset":1206},"end":{"line":28,"column":4,"offset":1303}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You take a ReactElement through ","position":{"start":{"line":30,"column":1,"offset":1305},"end":{"line":30,"column":33,"offset":1337}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">props.child</code>","position":{"start":{"line":30,"column":33,"offset":1337},"end":{"line":30,"column":46,"offset":1350}}},{"type":"text","value":" and mutate its property before rendering it. If this component’s state updates, this render function won’t actually get a new ReactElement in ","position":{"start":{"line":30,"column":46,"offset":1350},"end":{"line":30,"column":189,"offset":1493}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">props.child</code>","position":{"start":{"line":30,"column":189,"offset":1493},"end":{"line":30,"column":202,"offset":1506}}},{"type":"text","value":". It will be the same one. You’re mutating the same props.","position":{"start":{"line":30,"column":202,"offset":1506},"end":{"line":30,"column":260,"offset":1564}}}],"position":{"start":{"line":30,"column":1,"offset":1305},"end":{"line":30,"column":260,"offset":1564}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You could imagine that this would work. However, this disables the ability for any component to use ","position":{"start":{"line":32,"column":1,"offset":1566},"end":{"line":32,"column":101,"offset":1666}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">shouldComponentUpdate</code>","position":{"start":{"line":32,"column":101,"offset":1666},"end":{"line":32,"column":124,"offset":1689}}},{"type":"text","value":". It looks like the component never changed because the previous value is always the same as the next one. Since the DOM layer does diffing, this pattern doesn’t even work in this case. The change will never propagate down to the DOM except the first time.","position":{"start":{"line":32,"column":124,"offset":1689},"end":{"line":32,"column":380,"offset":1945}}}],"position":{"start":{"line":32,"column":1,"offset":1566},"end":{"line":32,"column":380,"offset":1945}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Additionally, if this element is reused in other places or used to switch back and forth between two modes, then you have all kinds of weird race conditions.","position":{"start":{"line":34,"column":1,"offset":1947},"end":{"line":34,"column":158,"offset":2104}}}],"position":{"start":{"line":34,"column":1,"offset":1947},"end":{"line":34,"column":158,"offset":2104}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It has always been broken to mutate the props of something passed into you. The problem is that we can’t warn you about this special case if you accidentally do this.","position":{"start":{"line":36,"column":1,"offset":2106},"end":{"line":36,"column":167,"offset":2272}}}],"position":{"start":{"line":36,"column":1,"offset":2106},"end":{"line":36,"column":167,"offset":2272}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-too-late-validation"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-too-late-validation","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: Too Late Validation ","position":{"start":{"line":38,"column":5,"offset":2278},"end":{"line":38,"column":64,"offset":2337}}}],"position":{"start":{"line":38,"column":1,"offset":2274},"end":{"line":38,"column":64,"offset":2337}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In React 0.12, we do PropType validation very deep inside React during mounting. This means that by the time you get an error, the debugger stack is long gone. This makes it difficult to find complex issues during debugging. We have to do this since it is fairly common for extra props to be added between the call to React.createElement and the mount time. So the type is incomplete until then.","position":{"start":{"line":40,"column":1,"offset":2339},"end":{"line":40,"column":396,"offset":2734}}}],"position":{"start":{"line":40,"column":1,"offset":2339},"end":{"line":40,"column":396,"offset":2734}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The static analysis in Flow is also impaired by this. There is no convenient place in the code where Flow can determine that the props are finalized.","position":{"start":{"line":42,"column":1,"offset":2736},"end":{"line":42,"column":150,"offset":2885}}}],"position":{"start":{"line":42,"column":1,"offset":2736},"end":{"line":42,"column":150,"offset":2885}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"solution-immutable-props"},"children":[{"type":"element","tagName":"a","properties":{"href":"#solution-immutable-props","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Solution: Immutable Props ","position":{"start":{"line":44,"column":5,"offset":2891},"end":{"line":44,"column":58,"offset":2944}}}],"position":{"start":{"line":44,"column":1,"offset":2887},"end":{"line":44,"column":58,"offset":2944}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Therefore, we would like to be able to freeze the element.props object so that it is immediately immutable at the JSX callsite (or createElement). In React 0.13 we will start warning you if you mutate ","position":{"start":{"line":46,"column":1,"offset":2946},"end":{"line":46,"column":202,"offset":3147}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">element.props</code>","position":{"start":{"line":46,"column":202,"offset":3147},"end":{"line":46,"column":217,"offset":3162}}},{"type":"text","value":" after this point.","position":{"start":{"line":46,"column":217,"offset":3162},"end":{"line":46,"column":235,"offset":3180}}}],"position":{"start":{"line":46,"column":1,"offset":2946},"end":{"line":46,"column":235,"offset":3180}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can generally refactor these pattern to simply use two different JSX calls:","position":{"start":{"line":48,"column":1,"offset":3182},"end":{"line":48,"column":80,"offset":3261}}}],"position":{"start":{"line":48,"column":1,"offset":3182},"end":{"line":48,"column":80,"offset":3261}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shouldUseFoo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Foo</span></span> <span class=\"token attr-name\">foo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">10</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">bar</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Foo</span></span> <span class=\"token attr-name\">bar</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":50,"column":1,"offset":3263},"end":{"line":56,"column":4,"offset":3371}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"However, if you really need to dynamically build up your props you can just use a temporary object and spread it into JSX:","position":{"start":{"line":58,"column":1,"offset":3373},"end":{"line":58,"column":123,"offset":3495}}}],"position":{"start":{"line":58,"column":1,"offset":3373},"end":{"line":58,"column":123,"offset":3495}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">var</span> props <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> bar<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shouldUseFoo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  props<span class=\"token punctuation\">.</span>foo <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n  props<span class=\"token punctuation\">.</span>bar <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Foo</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">props</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":60,"column":1,"offset":3497},"end":{"line":67,"column":4,"offset":3621}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It is still OK to do deep mutations of objects. E.g:","position":{"start":{"line":69,"column":1,"offset":3623},"end":{"line":69,"column":53,"offset":3675}}}],"position":{"start":{"line":69,"column":1,"offset":3623},"end":{"line":69,"column":53,"offset":3675}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Foo</span></span> <span class=\"token attr-name\">nestedObject</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>myModel<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":71,"column":1,"offset":3677},"end":{"line":73,"column":4,"offset":3736}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In this case it’s still ok to mutate the myModel object in state. We recommend that you use fully immutable models. E.g. by using immutable-js. However, we realize that mutable models are still convenient in many cases. Therefore we’re only considering shallow freezing the props object that belongs to the ReactElement itself. Not nested objects.","position":{"start":{"line":75,"column":1,"offset":3738},"end":{"line":75,"column":348,"offset":4085}}}],"position":{"start":{"line":75,"column":1,"offset":3738},"end":{"line":75,"column":348,"offset":4085}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"solution-early-proptype-warnings"},"children":[{"type":"element","tagName":"a","properties":{"href":"#solution-early-proptype-warnings","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Solution: Early PropType Warnings ","position":{"start":{"line":77,"column":5,"offset":4091},"end":{"line":77,"column":74,"offset":4160}}}],"position":{"start":{"line":77,"column":1,"offset":4087},"end":{"line":77,"column":74,"offset":4160}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We will also start warning you for PropTypes at the JSX or createElement callsite. This will help debugging as you’ll have the stack trace right there. Similarly, Flow also validates PropTypes at this callsite.","position":{"start":{"line":79,"column":1,"offset":4162},"end":{"line":79,"column":211,"offset":4372}}}],"position":{"start":{"line":79,"column":1,"offset":4162},"end":{"line":79,"column":211,"offset":4372}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note: There are valid patterns that clones a ReactElement and adds additional props to it. In that case these additional props needs to be optional.","position":{"start":{"line":81,"column":1,"offset":4374},"end":{"line":81,"column":149,"offset":4522}}}],"position":{"start":{"line":81,"column":1,"offset":4374},"end":{"line":81,"column":149,"offset":4522}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">var</span> element1 <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Foo</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// extra prop is optional</span>\n<span class=\"token keyword\">var</span> element2 <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span>addons<span class=\"token punctuation\">.</span><span class=\"token function\">cloneWithProps</span><span class=\"token punctuation\">(</span>element1<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> extra<span class=\"token operator\">:</span> <span class=\"token string\">'prop'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":83,"column":1,"offset":4524},"end":{"line":86,"column":4,"offset":4656}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"owner"},"children":[{"type":"element","tagName":"a","properties":{"href":"#owner","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Owner ","position":{"start":{"line":88,"column":4,"offset":4661},"end":{"line":88,"column":18,"offset":4675}}}],"position":{"start":{"line":88,"column":1,"offset":4658},"end":{"line":88,"column":18,"offset":4675}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In React each child has both a “parent” and an “owner”. The owner is the component that created a ReactElement. I.e. the render method which contains the JSX or createElement callsite.","position":{"start":{"line":90,"column":1,"offset":4677},"end":{"line":90,"column":185,"offset":4861}}}],"position":{"start":{"line":90,"column":1,"offset":4677},"end":{"line":90,"column":185,"offset":4861}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":92,"column":1,"offset":4863},"end":{"line":98,"column":4,"offset":4935}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In this example, the owner of the ","position":{"start":{"line":100,"column":1,"offset":4937},"end":{"line":100,"column":35,"offset":4971}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">span</code>","position":{"start":{"line":100,"column":35,"offset":4971},"end":{"line":100,"column":41,"offset":4977}}},{"type":"text","value":" is ","position":{"start":{"line":100,"column":41,"offset":4977},"end":{"line":100,"column":45,"offset":4981}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">Foo</code>","position":{"start":{"line":100,"column":45,"offset":4981},"end":{"line":100,"column":50,"offset":4986}}},{"type":"text","value":" but the parent is the ","position":{"start":{"line":100,"column":50,"offset":4986},"end":{"line":100,"column":73,"offset":5009}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">div</code>","position":{"start":{"line":100,"column":73,"offset":5009},"end":{"line":100,"column":78,"offset":5014}}},{"type":"text","value":".","position":{"start":{"line":100,"column":78,"offset":5014},"end":{"line":100,"column":79,"offset":5015}}}],"position":{"start":{"line":100,"column":1,"offset":4937},"end":{"line":100,"column":79,"offset":5015}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There is also an undocumented feature called “context” that also relies on the concept of an “owner” to pass hidden props down the tree.","position":{"start":{"line":102,"column":1,"offset":5017},"end":{"line":102,"column":137,"offset":5153}}}],"position":{"start":{"line":102,"column":1,"offset":5017},"end":{"line":102,"column":137,"offset":5153}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-the-semantics-are-opaque-and-confusing"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-the-semantics-are-opaque-and-confusing","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: The Semantics are Opaque and Confusing ","position":{"start":{"line":104,"column":5,"offset":5159},"end":{"line":104,"column":102,"offset":5256}}}],"position":{"start":{"line":104,"column":1,"offset":5155},"end":{"line":104,"column":102,"offset":5256}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The problem is that these are hidden artifacts attached to the ReactElement. In fact, you probably didn’t even know about it. It silently changes semantics. Take this for example:","position":{"start":{"line":106,"column":1,"offset":5258},"end":{"line":106,"column":180,"offset":5437}}}],"position":{"start":{"line":106,"column":1,"offset":5258},"end":{"line":106,"column":180,"offset":5437}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">var</span> foo <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>foo<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> bar <span class=\"token operator\">?</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bar<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span> <span class=\"token operator\">:</span> foo<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":108,"column":1,"offset":5439},"end":{"line":115,"column":4,"offset":5572}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"These two inputs have different owners, therefore React will not keep its state when the conditional switches. There is nothing in the code to indicate that. Similarly, if you use ","position":{"start":{"line":117,"column":1,"offset":5574},"end":{"line":117,"column":181,"offset":5754}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">React.addons.cloneWithProps</code>","position":{"start":{"line":117,"column":181,"offset":5754},"end":{"line":117,"column":210,"offset":5783}}},{"type":"text","value":", the owner changes.","position":{"start":{"line":117,"column":210,"offset":5783},"end":{"line":117,"column":230,"offset":5803}}}],"position":{"start":{"line":117,"column":1,"offset":5574},"end":{"line":117,"column":230,"offset":5803}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-timing-matters"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-timing-matters","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: Timing Matters ","position":{"start":{"line":119,"column":5,"offset":5809},"end":{"line":119,"column":54,"offset":5858}}}],"position":{"start":{"line":119,"column":1,"offset":5805},"end":{"line":119,"column":54,"offset":5858}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The owner is tracked by the currently executing stack. This means that the semantics of a ReactElement varies depending on when it is executed. Take this example:","position":{"start":{"line":121,"column":1,"offset":5860},"end":{"line":121,"column":163,"offset":6022}}}],"position":{"start":{"line":121,"column":1,"offset":5860},"end":{"line":121,"column":163,"offset":6022}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">B</span></span> <span class=\"token attr-name\">renderer</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">text</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">B</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">renderer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":123,"column":1,"offset":6024},"end":{"line":134,"column":4,"offset":6187}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The owner of the ","position":{"start":{"line":136,"column":1,"offset":6189},"end":{"line":136,"column":18,"offset":6206}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">span</code>","position":{"start":{"line":136,"column":18,"offset":6206},"end":{"line":136,"column":24,"offset":6212}}},{"type":"text","value":" is actually ","position":{"start":{"line":136,"column":24,"offset":6212},"end":{"line":136,"column":37,"offset":6225}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">B</code>","position":{"start":{"line":136,"column":37,"offset":6225},"end":{"line":136,"column":40,"offset":6228}}},{"type":"text","value":", not ","position":{"start":{"line":136,"column":40,"offset":6228},"end":{"line":136,"column":46,"offset":6234}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">A</code>","position":{"start":{"line":136,"column":46,"offset":6234},"end":{"line":136,"column":49,"offset":6237}}},{"type":"text","value":" because of the timing of the callback. This all adds complexity and suffers from similar problems as mutation.","position":{"start":{"line":136,"column":49,"offset":6237},"end":{"line":136,"column":160,"offset":6348}}}],"position":{"start":{"line":136,"column":1,"offset":6189},"end":{"line":136,"column":160,"offset":6348}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-it-couples-jsx-to-react"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-it-couples-jsx-to-react","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: It Couples JSX to React ","position":{"start":{"line":138,"column":5,"offset":6354},"end":{"line":138,"column":72,"offset":6421}}}],"position":{"start":{"line":138,"column":1,"offset":6350},"end":{"line":138,"column":72,"offset":6421}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Have you wondered why JSX depends on React? Couldn’t the transpiler have that built-in to its runtime? The reason you need to have ","position":{"start":{"line":140,"column":1,"offset":6423},"end":{"line":140,"column":132,"offset":6554}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">React.createElement</code>","position":{"start":{"line":140,"column":132,"offset":6554},"end":{"line":140,"column":153,"offset":6575}}},{"type":"text","value":" in scope is because we depend on internal state of React to capture the current “owner”. Without this, you wouldn’t need to have React in scope.","position":{"start":{"line":140,"column":153,"offset":6575},"end":{"line":140,"column":298,"offset":6720}}}],"position":{"start":{"line":140,"column":1,"offset":6423},"end":{"line":140,"column":298,"offset":6720}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"solution-make-context-parent-based-instead-of-owner-based"},"children":[{"type":"element","tagName":"a","properties":{"href":"#solution-make-context-parent-based-instead-of-owner-based","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Solution: Make Context Parent-Based Instead of Owner-Based ","position":{"start":{"line":142,"column":5,"offset":6726},"end":{"line":142,"column":124,"offset":6845}}}],"position":{"start":{"line":142,"column":1,"offset":6722},"end":{"line":142,"column":124,"offset":6845}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The first thing we’re doing is warning you if you’re using the “owner” feature in a way that relies on it propagating through owners. Instead, we’re planning on propagating it through parents to its children. In almost all cases, this shouldn’t matter. In fact, parent-based contexts is simply a superset.","position":{"start":{"line":144,"column":1,"offset":6847},"end":{"line":144,"column":306,"offset":7152}}}],"position":{"start":{"line":144,"column":1,"offset":6847},"end":{"line":144,"column":306,"offset":7152}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"solution-remove-the-semantic-implications-of-owner"},"children":[{"type":"element","tagName":"a","properties":{"href":"#solution-remove-the-semantic-implications-of-owner","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Solution: Remove the Semantic Implications of Owner ","position":{"start":{"line":146,"column":5,"offset":7158},"end":{"line":146,"column":110,"offset":7263}}}],"position":{"start":{"line":146,"column":1,"offset":7154},"end":{"line":146,"column":110,"offset":7263}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It turns out that there are very few cases where owners are actually important part of state-semantics. As a precaution, we’ll warn you if it turns out that the owner is important to determine state. In almost every case this shouldn’t matter. Unless you’re doing some weird optimizations, you shouldn’t see this warning.","position":{"start":{"line":148,"column":1,"offset":7265},"end":{"line":148,"column":322,"offset":7586}}}],"position":{"start":{"line":148,"column":1,"offset":7265},"end":{"line":148,"column":322,"offset":7586}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"pending-change-the-refs-semantics"},"children":[{"type":"element","tagName":"a","properties":{"href":"#pending-change-the-refs-semantics","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Pending: Change the refs Semantics ","position":{"start":{"line":150,"column":5,"offset":7592},"end":{"line":150,"column":76,"offset":7663}}}],"position":{"start":{"line":150,"column":1,"offset":7588},"end":{"line":150,"column":76,"offset":7663}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Refs are still based on “owner”. We haven’t fully solved this special case just yet.","position":{"start":{"line":152,"column":1,"offset":7665},"end":{"line":152,"column":85,"offset":7749}}}],"position":{"start":{"line":152,"column":1,"offset":7665},"end":{"line":152,"column":85,"offset":7749}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In 0.13 we introduced a new callback-refs API that doesn’t suffer from these problems but we’ll keep on a nice declarative alternative to the current semantics for refs. As always, we won’t deprecate something until we’re sure that you’ll have a nice upgrade path.","position":{"start":{"line":154,"column":1,"offset":7751},"end":{"line":154,"column":265,"offset":8015}}}],"position":{"start":{"line":154,"column":1,"offset":7751},"end":{"line":154,"column":265,"offset":8015}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"keyed-objects-as-maps"},"children":[{"type":"element","tagName":"a","properties":{"href":"#keyed-objects-as-maps","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Keyed Objects as Maps ","position":{"start":{"line":156,"column":4,"offset":8020},"end":{"line":156,"column":50,"offset":8066}}}],"position":{"start":{"line":156,"column":1,"offset":8017},"end":{"line":156,"column":50,"offset":8066}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In React 0.12, and earlier, you could use keyed objects to provide an external key to an element or a set. This pattern isn’t actually widely used. It shouldn’t be an issue for most of you.","position":{"start":{"line":158,"column":1,"offset":8068},"end":{"line":158,"column":190,"offset":8257}}}],"position":{"start":{"line":158,"column":1,"offset":8068},"end":{"line":158,"column":190,"offset":8257}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span> <span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":160,"column":1,"offset":8259},"end":{"line":162,"column":4,"offset":8310}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-relies-on-enumeration-order"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-relies-on-enumeration-order","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: Relies on Enumeration Order ","position":{"start":{"line":164,"column":5,"offset":8316},"end":{"line":164,"column":80,"offset":8391}}}],"position":{"start":{"line":164,"column":1,"offset":8312},"end":{"line":164,"column":80,"offset":8391}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The problem with this pattern is that it relies on enumeration order of objects. This is technically unspecified, even though implementations now agree to use insertion order. Except for the special case when numeric keys are used.","position":{"start":{"line":166,"column":1,"offset":8393},"end":{"line":166,"column":232,"offset":8624}}}],"position":{"start":{"line":166,"column":1,"offset":8393},"end":{"line":166,"column":232,"offset":8624}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-using-objects-as-maps-is-bad"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-using-objects-as-maps-is-bad","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: Using Objects as Maps is Bad ","position":{"start":{"line":168,"column":5,"offset":8630},"end":{"line":168,"column":82,"offset":8707}}}],"position":{"start":{"line":168,"column":1,"offset":8626},"end":{"line":168,"column":82,"offset":8707}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"It is generally accepted that using objects as maps screw up type systems, VM optimizations, compilers etc. It is much better to use a dedicated data structure like ES6 Maps.","position":{"start":{"line":170,"column":1,"offset":8709},"end":{"line":170,"column":175,"offset":8883}}}],"position":{"start":{"line":170,"column":1,"offset":8709},"end":{"line":170,"column":175,"offset":8883}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"More importantly, this can have important security implications. For example this has a potential security problem:","position":{"start":{"line":172,"column":1,"offset":8885},"end":{"line":172,"column":116,"offset":9000}}}],"position":{"start":{"line":172,"column":1,"offset":8885},"end":{"line":172,"column":116,"offset":9000}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">var</span> children <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nitems<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> children<span class=\"token punctuation\">[</span>item<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span></code></pre></div>","position":{"start":{"line":174,"column":1,"offset":9002},"end":{"line":178,"column":4,"offset":9116}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Imagine if ","position":{"start":{"line":180,"column":1,"offset":9118},"end":{"line":180,"column":12,"offset":9129}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">item.title === &#39;__proto__&#39;</code>","position":{"start":{"line":180,"column":12,"offset":9129},"end":{"line":180,"column":40,"offset":9157}}},{"type":"text","value":" for example.","position":{"start":{"line":180,"column":40,"offset":9157},"end":{"line":180,"column":53,"offset":9170}}}],"position":{"start":{"line":180,"column":1,"offset":9118},"end":{"line":180,"column":53,"offset":9170}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"problem-cant-be-differentiated-from-arbitrary-objects"},"children":[{"type":"element","tagName":"a","properties":{"href":"#problem-cant-be-differentiated-from-arbitrary-objects","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Problem: Can’t be Differentiated from Arbitrary Objects ","position":{"start":{"line":182,"column":5,"offset":9176},"end":{"line":182,"column":117,"offset":9288}}}],"position":{"start":{"line":182,"column":1,"offset":9172},"end":{"line":182,"column":117,"offset":9288}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Since these objects can have any keys with almost any value, we can’t differentiate them from a mistake. If you put some random object, we will try our best to traverse it and render it, instead of failing with a helpful warning. In fact, this is one of the few places where you can accidentally get an infinite loop in React.","position":{"start":{"line":184,"column":1,"offset":9290},"end":{"line":184,"column":327,"offset":9616}}}],"position":{"start":{"line":184,"column":1,"offset":9290},"end":{"line":184,"column":327,"offset":9616}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To differentiate ReactElements from one of these objects, we have to tag them with ","position":{"start":{"line":186,"column":1,"offset":9618},"end":{"line":186,"column":84,"offset":9701}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">_isReactElement</code>","position":{"start":{"line":186,"column":84,"offset":9701},"end":{"line":186,"column":101,"offset":9718}}},{"type":"text","value":". This is another issue preventing us from inlining ReactElements as simple object literals.","position":{"start":{"line":186,"column":101,"offset":9718},"end":{"line":186,"column":193,"offset":9810}}}],"position":{"start":{"line":186,"column":1,"offset":9618},"end":{"line":186,"column":193,"offset":9810}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"solution-just-use-an-array-and-key"},"children":[{"type":"element","tagName":"a","properties":{"href":"#solution-just-use-an-array-and-key","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Solution: Just use an Array and key={…} ","position":{"start":{"line":188,"column":5,"offset":9816},"end":{"line":188,"column":82,"offset":9893}}}],"position":{"start":{"line":188,"column":1,"offset":9812},"end":{"line":188,"column":82,"offset":9893}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Most of the time you can just use an array with keyed ReactElements.","position":{"start":{"line":190,"column":1,"offset":9895},"end":{"line":190,"column":69,"offset":9963}}}],"position":{"start":{"line":190,"column":1,"offset":9895},"end":{"line":190,"column":69,"offset":9963}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token keyword\">var</span> children <span class=\"token operator\">=</span> items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":192,"column":1,"offset":9965},"end":{"line":195,"column":4,"offset":10057}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"solution-reactaddonscreatefragment"},"children":[{"type":"element","tagName":"a","properties":{"href":"#solution-reactaddonscreatefragment","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Solution: React.addons.createFragment ","position":{"start":{"line":197,"column":5,"offset":10063},"end":{"line":197,"column":80,"offset":10138}}}],"position":{"start":{"line":197,"column":1,"offset":10059},"end":{"line":197,"column":80,"offset":10138}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"However, this is not always possible if you’re trying to add a prefix key to an unknown set (e.g. this.props.children). It is also not always the easiest upgrade path. Therefore, we are adding a helper to ","position":{"start":{"line":199,"column":1,"offset":10140},"end":{"line":199,"column":206,"offset":10345}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">React.addons</code>","position":{"start":{"line":199,"column":206,"offset":10345},"end":{"line":199,"column":220,"offset":10359}}},{"type":"text","value":" called ","position":{"start":{"line":199,"column":220,"offset":10359},"end":{"line":199,"column":228,"offset":10367}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">createFragment()</code>","position":{"start":{"line":199,"column":228,"offset":10367},"end":{"line":199,"column":246,"offset":10385}}},{"type":"text","value":". This accepts a keyed object and returns an opaque type.","position":{"start":{"line":199,"column":246,"offset":10385},"end":{"line":199,"column":303,"offset":10442}}}],"position":{"start":{"line":199,"column":1,"offset":10140},"end":{"line":199,"column":303,"offset":10442}}},{"type":"text","value":"\n"},{"type":"raw","value":"<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"gatsby-code-jsx\"><code class=\"gatsby-code-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>React<span class=\"token punctuation\">.</span>addons<span class=\"token punctuation\">.</span><span class=\"token function\">createFragment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> a<span class=\"token operator\">:</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":201,"column":1,"offset":10444},"end":{"line":203,"column":4,"offset":10534}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The exact signature of this kind of fragment will be determined later. It will likely be some kind of immutable sequence.","position":{"start":{"line":205,"column":1,"offset":10536},"end":{"line":205,"column":122,"offset":10657}}}],"position":{"start":{"line":205,"column":1,"offset":10536},"end":{"line":205,"column":122,"offset":10657}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note: This will still not be valid as the direct return value of ","position":{"start":{"line":207,"column":1,"offset":10659},"end":{"line":207,"column":66,"offset":10724}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">render()</code>","position":{"start":{"line":207,"column":66,"offset":10724},"end":{"line":207,"column":76,"offset":10734}}},{"type":"text","value":". Unfortunately, they still need to be wrapped in a ","position":{"start":{"line":207,"column":76,"offset":10734},"end":{"line":207,"column":128,"offset":10786}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">&lt;div /&gt;</code>","position":{"start":{"line":207,"column":128,"offset":10786},"end":{"line":207,"column":137,"offset":10795}}},{"type":"text","value":" or some other element.","position":{"start":{"line":207,"column":137,"offset":10795},"end":{"line":207,"column":160,"offset":10818}}}],"position":{"start":{"line":207,"column":1,"offset":10659},"end":{"line":207,"column":160,"offset":10818}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"compiler-optimizations-unlocked"},"children":[{"type":"element","tagName":"a","properties":{"href":"#compiler-optimizations-unlocked","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Compiler Optimizations: Unlocked! ","position":{"start":{"line":209,"column":4,"offset":10823},"end":{"line":209,"column":72,"offset":10891}}}],"position":{"start":{"line":209,"column":1,"offset":10820},"end":{"line":209,"column":72,"offset":10891}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"These changes also unlock several possible compiler optimizations for static content in React 0.14. These optimizations were previously only available to template-based frameworks. They will now also be possible for React code! Both for JSX and ","position":{"start":{"line":211,"column":1,"offset":10893},"end":{"line":211,"column":246,"offset":11138}}},{"type":"raw","value":"<code class=\"gatsby-code-text\">React.createElement/Factory</code>","position":{"start":{"line":211,"column":246,"offset":11138},"end":{"line":211,"column":275,"offset":11167}}},{"type":"text","value":"*!","position":{"start":{"line":211,"column":275,"offset":11167},"end":{"line":211,"column":277,"offset":11169}}}],"position":{"start":{"line":211,"column":1,"offset":10893},"end":{"line":211,"column":277,"offset":11169}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"See these GitHub Issues for a deep dive into compiler optimizations:","position":{"start":{"line":213,"column":1,"offset":11171},"end":{"line":213,"column":69,"offset":11239}}}],"position":{"start":{"line":213,"column":1,"offset":11171},"end":{"line":213,"column":69,"offset":11239}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/facebook/react/issues/3226","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"Reuse Constant Value Types","position":{"start":{"line":215,"column":4,"offset":11244},"end":{"line":215,"column":30,"offset":11270}}}],"position":{"start":{"line":215,"column":3,"offset":11243},"end":{"line":215,"column":78,"offset":11318}}}],"position":{"start":{"line":215,"column":1,"offset":11241},"end":{"line":215,"column":78,"offset":11318}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/facebook/react/issues/3227","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"Tagging ReactElements","position":{"start":{"line":216,"column":4,"offset":11322},"end":{"line":216,"column":25,"offset":11343}}}],"position":{"start":{"line":216,"column":3,"offset":11321},"end":{"line":216,"column":73,"offset":11391}}}],"position":{"start":{"line":216,"column":1,"offset":11319},"end":{"line":216,"column":73,"offset":11391}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/facebook/react/issues/3228","target":"_blank","rel":"nofollow noopener noreferrer"},"children":[{"type":"text","value":"Inline ReactElements","position":{"start":{"line":217,"column":4,"offset":11395},"end":{"line":217,"column":24,"offset":11415}}}],"position":{"start":{"line":217,"column":3,"offset":11394},"end":{"line":217,"column":72,"offset":11463}}}],"position":{"start":{"line":217,"column":1,"offset":11392},"end":{"line":217,"column":72,"offset":11463}}},{"type":"text","value":"\n"}],"position":{"start":{"line":215,"column":1,"offset":11241},"end":{"line":217,"column":72,"offset":11463}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"*","position":{"start":{"line":219,"column":1,"offset":11465},"end":{"line":219,"column":3,"offset":11467}}},{"type":"text","value":" If you use the recommended pattern of explicit React.createFactory calls on the consumer side - since they are easily statically analyzed.","position":{"start":{"line":219,"column":3,"offset":11467},"end":{"line":219,"column":142,"offset":11606}}}],"position":{"start":{"line":219,"column":1,"offset":11465},"end":{"line":219,"column":142,"offset":11606}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"rationale"},"children":[{"type":"element","tagName":"a","properties":{"href":"#rationale","aria-hidden":true,"class":"anchor"},"children":[{"type":"raw","value":"<svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg>"}]},{"type":"text","value":"Rationale ","position":{"start":{"line":221,"column":4,"offset":11611},"end":{"line":221,"column":26,"offset":11633}}}],"position":{"start":{"line":221,"column":1,"offset":11608},"end":{"line":221,"column":26,"offset":11633}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I thought that these changes were particularly important because the mere existence of these patterns means that even components that DON’T use these patterns have to pay the price. There are other problematic patterns such as mutating state, but they’re at least localized to a component subtree so they don’t harm the ecosystem.","position":{"start":{"line":223,"column":1,"offset":11635},"end":{"line":223,"column":331,"offset":11965}}}],"position":{"start":{"line":223,"column":1,"offset":11635},"end":{"line":223,"column":331,"offset":11965}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As always, we’d love to hear your feedback and if you have any trouble upgrading, please let us know.","position":{"start":{"line":225,"column":1,"offset":11967},"end":{"line":225,"column":102,"offset":12068}}}],"position":{"start":{"line":225,"column":1,"offset":11967},"end":{"line":225,"column":102,"offset":12068}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":226,"column":1,"offset":12069}}}}